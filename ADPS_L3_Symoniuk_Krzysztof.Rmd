---
title: "ADPS 2025Z --- Laboratorium 3 (rozwiązania)"
author: "Imię i Nazwisko"
output:
  pdf_document: 
    latex_engine: xelatex
  html_document: default
  html_notebook: default
---

```{r, echo=FALSE}
pdf.options(encoding='ISOLatin2')
```

# Zadanie 1 (1 pkt)

## Treść zadania

Plik tempciala.txt zawiera zarejestrowane wartości tętna oraz temperatury ciała dla 65 mężczyzn (płeć = 1) i 65 kobiet (płeć = 2).

Osobno dla mężczyzn i kobiet:

* wyestymuj wartość średnią i odchylenie standardowe temperatury,

* zweryfikuj przy poziomie istotności $\alpha = 0.05$ hipotezę, że średnia temperatura jest równa 36.6 $^\circ$C wobec hipotezy alternatywnej, że średnia temperatura jest inna, przyjmując, że temperatury mają rozkład normalny, a wariancja rozkładu jest nieznana.

## Rozwiązanie

```{r}
read.csv("tempciala.txt", header = TRUE, sep = ",") -> tc; tc
sr_temp_m <- mean(tc$temperatura[tc$płeć == 1]); sr_temp_m
sr_temp_k <- mean(tc$temperatura[tc$płeć == 2]); sr_temp_k
odch_std_m <- sd(tc$temperatura[tc$płeć == 1]); odch_std_m
odch_std_k <- sd(tc$temperatura[tc$płeć == 2]); odch_std_k
```
```{r}
tc_m <- (tc$temperatura[tc$płeć == 1]); tc_m
tc_k <- (tc$temperatura[tc$płeć == 2]); tc_k
mi_0 = 36.6
alfa = 0.05
t.test(tc_m, mu = mi_0, alternative = "two.sided") -> test_m;
t.test(tc_k, mu = mi_0, alternative = "two.sided") -> test_k;
```
Hipotezę zerową odrzucamy bo p-value jest mniejsza od lambda

***

# Zadanie 2 (1 pkt)

## Treść zadania

W tabeli przedstawionej poniżej zawarto dane dot. liczby samobójstw w Stanach Zjednoczonych w 1970 roku z podziałem na poszczególne miesiące.

| Miesiąc     | Liczba samobójstw | Liczba dni |
| :---        |          :----:   |   :----:   |
| Styczeń     | 1867              | 31         |
| Luty        | 1789              | 28         |
| Marzec      | 1944              | 31         |
| Kwiecień    | 2094              | 30         |
| Maj         | 2097              | 31         |
| Czerwiec    | 1981              | 30         |
| Lipiec      | 1887              | 31         |
| Sierpień    | 2024              | 31         |
| Wrzesień    | 1928              | 30         |
| Październik | 2032              | 31         |
| Listopad    | 1978              | 30         |
| Grudzień    | 1859              | 31         |

Zweryfikuj przy poziomie istotności $\alpha = 0.05$ czy zamieszczone w niej dane świadczą o stałej intensywności badanego zjawiska, czy raczej wskazują na sezonową zmienność liczby samobójstw. Przyjmij, że w przypadku stałej intensywności liczby samobójstw, liczba samobójstw w danym miesiącu jest proporcjonalna do liczby dni w tym miesiącu.

## Rozwiązanie
```{r}
ni_i = c(1867,1789,1944,2094,2097,1981,1887,2024,1928,2032,1978,1859)
dni = c(31,28,31,30,31,30,31,31,30,31,30,31)

n = sum(ni_i)
p_i = dni / sum(dni); p_i

T = sum((ni_i - n*p_i)^2 / (n*p_i))
r = length(ni_i)
alfa = 0.05

c = qchisq(1 - alfa, r - 1)
p_val = 1 - pchisq(T, r - 1)

T; c; p_val

chisq.test(x = ni_i, p = p_i)

```
T > c i p < alfa - odrzucamy H0, sezonowość jest istotna.

***

# Zadanie 3 (1 pkt)

## Treść zadania

Dla wybranej spółki notowanej na GPW wczytaj dane ze strony stooq.pl, a następnie

* oblicz wartości procentowych zmian najniższych cen w poszczególnych dniach w ciągu ostatniego roku, wykreśl ich histogram i narysuj funkcję gęstości prawdopodobieństwa rozkładu normalnego o parametrach wyestymowanych na podstawie ich wartości,

* stosując rózne testy omawiane w przykładach zweryfikuj przy poziomie istotności $\alpha = 0.05$ hipotezę, że procentowe zmiany najniższych cen w poszczególnych dniach w ciągu ostatniego roku mają rozkład normalny.

## Rozwiązanie

```{r}
# https://stooq.pl/q/d/l/?s=kgh&i=d
Ticket = 'KGH'
webLink = paste0('https://stooq.pl/q/d/l/?s=', Ticket, '&i=d')
fileName = paste0(Ticket, '.csv')
if(!file.exists(fileName)) {
download.file(webLink, fileName)
}
```

```{r}
df_KGH = read.csv('KGH.csv')
df_KGH$Data = as.Date(df_KGH$Data)
df_KGH$Najnizszy_zm = with(df_KGH, c(NA, 100*diff(Najnizszy)/Najnizszy[-length(Najnizszy)]))
df_KGH_1rok = df_KGH[which(df_KGH$Data >= '2024-12-12' & df_KGH$Data <= Sys.Date()),]
m = mean(df_KGH_1rok$Najnizszy_zm, na.rm = T)
s = sd(df_KGH_1rok$Najnizszy_zm, na.rm = T)
hist(df_KGH_1rok$Najnizszy_zm, breaks = 50, prob = T,
xlab = 'Zmiana najniższych cen [%]',
ylab = 'Częstość występowania',
main = paste('Histogram procentowych zmian kursu', 'KGHM'))
grid()
min_c = min(df_KGH_1rok$Najnizszy_zm, na.rm = T)
max_c = max(df_KGH_1rok$Najnizszy_zm, na.rm = T)
curve(dnorm(x, mean = m, sd = s), add = TRUE, col = 'red', from = min_c, to = max_c)

```
```{r}
ni_i_KGH = c(df_KGH_1rok$Najnizszy_zm)
dni_KGH = rep(1/365, 365)

n_KGH = sum(df_KGH_1rok$Najnizszy_zm)
p_i_KGH = dni_KGH / sum(dni_KGH)

T = sum((ni_i_KGH - n*p_i_KGH)^2 / (n_KGH*p_i_KGH))
r = length(ni_i_KGH)
alfa = 0.05

c = qchisq(1 - alfa, r - 1)
p_val = 1 - pchisq(T, r - 1)

T; c; p_val

# chisq.test(x = ni_i_KGH, p = p_i_KGH)
```
```{r}

```

***

# Zadanie 4 (1 pkt)

## Treść zadania

W pliku lozyska.txt podane są czasy (w milionach cykli) pracy (do momentu uszkodzenia) łożysk wykonywanych z dwóch różnych materiałów.

* Przeprowadź test braku różnicy między czasami pracy łożysk wykonanych z różnych materiałów, zakładając że czas pracy do momentu uszkodzenia opisuje się rozkładem normalnym, bez zakładania róności wariancji. Przyjmij poziom istotności $\alpha = 0.05$.

* Przeprowadź analogiczny test, bez zakładania normalności rozkładów.

* **(dla chętnych)** Oszacuj prawdopodobieństwo tego, że łożysko wykonane z pierwszego materiału będzie pracowało dłużej niż łożysko wykonane z materiału drugiego.

## Rozwiązanie

Tu umieść swoje rozwiązanie

***

# Zadanie 5 (1 pkt)

## Treść zadania

Korzystając z danych zawartych na stronie pl.fcstats.com zweryfikuj hipotezę o niezależności wyników (zwycięstw, remisów i porażek) gospodarzy od kraju, w którym prowadzone są rozgrywki piłkarskie. Przyjmij poziom istotności $\alpha = 0.05$.

* Testy przeprowadź na podstawie danych dotyczących lig:

    * niemieckiej – Bundesliga (Liga niemiecka),
    
    * polskiej – Ekstraklasa (Liga polska),
    
    * angielskiej – Premier League (Liga angielska),
    
    * hiszpańskiej – LaLiga (Liga hiszpańska).
    
* Dane znajdują się w zakładce Porównanie lig -> Zwycięzcy meczów, w kolumnach (bez znaku [%]):

    * 1 – zwycięstwa gospodarzy, np. dla ligi niemieckiej (Bundesliga) 125,
    
    * x – remisy, np. dla ligi niemieckiej 86,
    
    * 2 – porażki gospodarzy, np. dla ligi niemieckiej 95.

## Rozwiązanie

Tu umieść swoje rozwiązanie

***